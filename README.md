# 股票行情划线选股

## 项目简介

**股票行情划线选股** 是一个基于 HTML、JavaScript 和 D3.js 的 Web 项目，用于分析股票的分时图数据，筛选符合特定条件的股票（如拉升横盘）。用户可以通过输入股票代码或加载预定义的股票列表，快速查看符合条件的股票及其分时图。

---

## 功能特性

- **股票分时图查询**：
  - 支持通过股票代码查询分时图数据。
  - 支持从预定义的股票列表文件加载股票代码。

- **参数化筛选**：
  - 用户可自定义筛选条件，如横盘持续时间、价格波动范围、拉升幅度等。

- **结果展示**：
  - 展示符合条件的股票分时图，支持点击展开或折叠。
  - 显示不符合条件的股票列表，支持点击展开查看。

- **便捷操作**：
  - 点击股票代码可自动复制代码（仅保留6位数字）。
  - 使用 Toast 提示操作结果（如复制成功）。
  - 点击股票名称可折叠或展开对应的分时图。

- **文件管理**：
  - 支持通过后端 PHP 脚本动态加载 `stockcodes` 文件夹中的股票列表文件。
  - 自动统计每个文件中的股票数量，并在文件选择器中显示。

---

## 项目结构

```
.
├── index.html                # 主页面
├── stockcodes.txt            # 股票代码列表文件
├── js/                       # JavaScript 文件
│   ├── drawChart.js          # 绘制分时图
│   ├── fetchStockData.js     # 获取股票数据
│   ├── main.js               # 主逻辑
│   ├── parameters.js         # 参数管理
│   └── stockAnalyze.js       # 股票分析逻辑
├── loadStockFiles.php        # 动态加载股票列表文件
├── stockcodes/               # 股票列表文件夹
```

---

## 使用方法

1. 克隆项目

```bash
git clone https://github.com/your-username/your-repo-name.git
cd your-repo-name
```

2. 启动项目  
直接打开 `index.html` 文件即可在浏览器中运行项目。

3. 配置筛选参数  
在页面顶部的 **参数设置区域** 中，调整以下参数：
- **横盘最小持续时间（分钟）**
- **横盘最大价格波动百分比**
- **拉升幅度阈值（百分比）**
- **拉升最大持续时间（分钟）**
- **横盘高度上限百分比**
- **横盘高度下限百分比**

点击 **应用参数** 按钮保存设置。

4. 查询股票  
- **输入股票代码**：在输入框中输入股票代码（用逗号分隔），点击 **查询** 按钮。  
- **加载股票列表**：如果未输入股票代码，系统会自动加载 `stockcodes.txt` 文件中的股票代码。  
- **选择文件**：通过文件选择器选择 `stockcodes` 文件夹中的股票列表文件。

5. 查看结果  
- **符合条件的股票**：  
  展示分时图，支持点击股票名称展开或折叠。  
  点击股票代码可复制代码到剪贴板。  
- **不符合条件的股票**：  
  显示股票名称和代码，支持点击展开查看。

---

## 技术栈

- **前端**：
  - HTML5
  - CSS3
  - JavaScript (ES6+)
  - Bootstrap 5
  - D3.js

- **后端**：
  - PHP

- **数据获取**：
  - 使用 API 获取股票分时图数据。

---

## 文件说明

### 1. `index.html`

主页面文件，包含以下内容：
- 参数设置区域
- 股票代码输入框
- 查询结果展示区域

### 2. `stockcodes.txt`

预定义的股票代码列表文件，支持添加备注信息。

### 3. `js/`

#### `drawChart.js`
- 使用 D3.js 绘制分时图，包括价格折线图和成交量柱状图。

#### `fetchStockData.js`
- 调用 API 获取股票分时图数据，并解析返回结果。

#### `main.js`
- 主逻辑文件，负责页面交互、数据处理和结果渲染。

#### `parameters.js`
- 管理筛选参数，支持动态更新。

#### `stockAnalyze.js`
- 实现股票分析逻辑，包括横盘和拉升区域的检测。

### 4. `loadStockFiles.php`
- 动态加载 `stockcodes` 文件夹中的股票列表文件。
- 统计每个文件中的股票数量，并返回给前端。

### 5. `stockcodes/`

股票列表文件夹，支持存储多个股票代码文件。

---

## 注意事项

1. **API 限制**：
   - 请确保 API 可用，且网络环境正常。

2. **浏览器兼容性**：
   - 推荐使用最新版本的 Chrome 或 Edge 浏览器。

3. **HTTPS 环境**：
   - 部分功能（如复制到剪贴板）需要在 HTTPS 环境下运行。

4. **后端支持**：
   - 确保 PHP 环境正常运行，以支持动态加载文件功能。

---

## 开发者

- **GitHub**：[QR4D](https://github.com/qr4d)

---

## 许可证

本项目采用 GPL-3.0 license 开源，欢迎自由使用和修改。

